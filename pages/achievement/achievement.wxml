<!-- achievement.wxml -->
<view class="container">
  <view class="page-title">æˆ‘çš„æˆå°±</view>
  
  <!-- æˆå°±ç»Ÿè®¡ -->
  <view class="achievement-stats card">
    <view class="stat-item">
      <text class="stat-number">{{completedCount}}</text>
      <text class="stat-label">å·²å®Œæˆ</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-number">{{totalCount}}</text>
      <text class="stat-label">æ€»æˆå°±</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-number">{{completedCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0}}</text>
      <text class="stat-label">å®Œæˆç‡%</text>
    </view>
  </view>
  
  <!-- æ ‡ç­¾åˆ‡æ¢ -->
  <view class="tab-bar">
    <view class="tab-item {{activeTab === 'all' ? 'active' : ''}}" bindtap="switchTab" data-tab="all">
      <text>å…¨éƒ¨</text>
    </view>
    <view class="tab-item {{activeTab === 'completed' ? 'active' : ''}}" bindtap="switchTab" data-tab="completed">
      <text>å·²å®Œæˆ</text>
    </view>
    <view class="tab-item {{activeTab === 'in_progress' ? 'active' : ''}}" bindtap="switchTab" data-tab="in_progress">
      <text>è¿›è¡Œä¸­</text>
    </view>
  </view>
  
  <!-- æˆå°±åˆ—è¡¨ -->
  <view class="achievement-list">
    <!-- åŠ è½½ä¸­ -->
    <view wx:if="{{isLoading}}" class="loading-container">
      <text>åŠ è½½ä¸­...</text>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:elif="{{!isLoading && achievements.length === 0}}" class="empty-container">
      <text>æš‚æ— æˆå°±</text>
    </view>
    
    <!-- æˆå°±é¡¹ -->
    <view wx:else class="achievement-items">
      <view class="achievement-item card" wx:for="{{achievements}}" wx:key="id" bindtap="goToAchievementDetail" data-id="{{item.id}}">
        <view class="achievement-header">
          <view class="achievement-info">
            <text class="achievement-name">{{item.achievementName}}</text>
            <text class="achievement-type">{{item.achievementType}}</text>
            <text class="achievement-level level-{{item.level}}">{{['åˆçº§', 'ä¸­çº§', 'é«˜çº§', 'ä¸“å®¶çº§'][item.level - 1]}}</text>
          </view>
          <view class="achievement-status {{item.isCompleted ? 'completed' : 'in-progress'}}">
            <text>{{item.isCompleted ? 'å·²å®Œæˆ' : 'è¿›è¡Œä¸­'}}</text>
          </view>
        </view>
        
        <view class="achievement-description">
          <text>{{item.description}}</text>
        </view>
        
        <view class="achievement-progress">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{(item.progress / item.target) * 100}}%"></view>
          </view>
          <view class="progress-text">
            <text>{{item.progress}}/{{item.target}}</text>
          </view>
        </view>
        
        <view class="achievement-footer">
          <view class="achievement-reward">
            <text class="reward-icon">ğŸ</text>
            <text class="reward-points">å¥–åŠ±ç§¯åˆ†ï¼š{{item.rewardPoints}}</text>
          </view>
          <view class="achievement-completed-time" wx:if="{{item.isCompleted}}">
            <text>å®Œæˆäºï¼š{{item.completedAt}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- åŒæ­¥æŒ‰é’® -->
  <view class="sync-button-container">
    <button class="sync-button" bindtap="syncAchievements">
      <text class="sync-icon">ğŸ”„</text>
      <text>åŒæ­¥æˆå°±è¿›åº¦</text>
    </button>
  </view>
</view>